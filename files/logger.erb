require 'action_controller/log_subscriber'
require 'pp'
ActionController::LogSubscriber.class_eval do
  # http://api.rubyonrails.org/classes/ActionController/LogSubscriber.html#method-i-start_processing
  def start_processing(event)
    return unless logger.info?

    payload = event.payload
    params  = payload[:params].except(*INTERNAL_PARAMS)
    format  = payload[:format]
    format  = format.to_s.upcase if format.is_a?(Symbol)

    info "Processing by #{payload[:controller]}##{payload[:action]} as #{format}"
    #info "  Parameters: #{params.inspect}" unless params.empty?
    info "  Parameters:\n#{params.pretty_inspect.lines.map{|l| "    #{l}"}.join}" unless params.empty?
  end
end
